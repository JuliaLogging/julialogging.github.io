<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How to filter messages · JuliaLogging</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/julialogging.css" rel="stylesheet" type="text/css"/><link href="../../assets/gruvbox-light-hard.css" rel="stylesheet" type="text/css"/><link href="../../assets/gruvbox-dark-hard.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuliaLogging logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaLogging</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../package-overview/">Logging package overview</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/logging-basics/">Logging basics</a></li><li><a class="tocitem" href="../../tutorials/working-with-loggers/">Working with loggers</a></li><li><a class="tocitem" href="../../tutorials/implement-a-new-logger/">Implement a new logger</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../enable-debug/">How to enable <code>@debug</code> messages</a></li><li><a class="tocitem" href="../log-to-file/">How to log to a file</a></li><li><a class="tocitem" href="../tee/">Send messages to multiple locations</a></li><li class="is-active"><a class="tocitem" href>How to filter messages</a></li><li><a class="tocitem" href="../rotate-log-files/">How to rotate log files</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/logcompose/">LogCompose.jl</a></li><li><a class="tocitem" href="../../reference/logging/">Logging.jl</a></li><li><a class="tocitem" href="../../reference/logging2/">Logging2.jl</a></li><li><a class="tocitem" href="../../reference/loggingextras/">LoggingExtras.jl</a></li><li><a class="tocitem" href="../../reference/loggingformats/">LoggingFormats.jl</a></li><li><a class="tocitem" href="../../reference/logroller/">LogRoller.jl</a></li><li><a class="tocitem" href="../../reference/lokilogger/">LokiLogger.jl</a></li><li><a class="tocitem" href="../../reference/progresslogging/">ProgressLogging.jl</a></li><li><a class="tocitem" href="../../reference/sysloglogging/">SyslogLogging.jl</a></li><li><a class="tocitem" href="../../reference/terminalloggers/">TerminalLoggers.jl</a></li><li><a class="tocitem" href="../../reference/miniloggers/">MiniLoggers.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How-to guides</a></li><li class="is-active"><a href>How to filter messages</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>How to filter messages</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaLogging/julialogging.github.io/blob/master/src/how-to/filter-messages.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-filter-messages"><a class="docs-heading-anchor" href="#How-to-filter-messages">How to filter messages</a><a id="How-to-filter-messages-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-filter-messages" title="Permalink"></a></h1><p>In this tutorial we will see how to filter messages based on the metadata (level, module, etc.) and the content of log messages. In <a href="../enable-debug/#How-to-enable-@debug-messages">How to enable <code>@debug</code> messages</a> and <a href="../tee/#Send-messages-to-multiple-locations">Send messages to multiple locations</a> there were examples of how to filter messages based on the log level, but not based on other things.</p><p>Messages can be filtered in two stages during the logging system message plumbing. In the first stage only the metadata is known (level, module, group, and id). In particular the message string itself has not been constructed yet. Filtering at this stage can be more efficient if the log message creation is expensive. For example, in</p><pre><code class="language-julia hljs"><span class="hljs-meta">@info</span> <span class="hljs-string">&quot;The value of some_expensive_call is: <span class="hljs-subst">$(<span class="hljs-built_in">some_expensive_call</span>(args<span class="hljs-built_in">.</span><span class="hljs-built_in">.</span><span class="hljs-built_in">.</span>))</span>&quot;</span>
</code></pre><p>the call to <code>some_expensive_call</code> has not happened yet in the early stage. Messages can also be filtered later, when more information is available, such as the full message string, file and line, and any keyword arguments.</p><h3 id="Early-filtering-using-EarlyFilteredLogger"><a class="docs-heading-anchor" href="#Early-filtering-using-EarlyFilteredLogger">Early filtering using <code>EarlyFilteredLogger</code></a><a id="Early-filtering-using-EarlyFilteredLogger-1"></a><a class="docs-heading-anchor-permalink" href="#Early-filtering-using-EarlyFilteredLogger" title="Permalink"></a></h3><p>Filtering in the early stage can be done with an <a href="../../reference/loggingextras/#LoggingExtras.EarlyFilteredLogger"><code>EarlyFilteredLogger</code></a> from the <a href="../../reference/loggingextras/#LoggingExtras.jl">LoggingExtras.jl</a> package. The <code>EarlyFilteredLogger</code> takes a predicate function and a logger as input arguments. If the predicate returns <code>true</code> the message is passed on to the wrapped logger, otherwise it is ignored. The predicate function is passed a named tuple, see <a href="../../reference/loggingextras/#LoggingExtras.shouldlog_args-Tuple"><code>LoggingExtras.shouldlog_args</code></a>, as the only input.</p><p>Here is an example of a logger that only accept (i) messages that are of <code>Logging.Info</code> level (<code>Logging.Info &lt;= level &lt; Logging.Warn</code>) and (ii) messages coming from the <code>Foo</code> module:</p><pre><code class="language-julia hljs"><span class="hljs-keyword">using</span> Logging, LoggingExtras

<span class="hljs-comment"># Define the Foo module</span>
<span class="hljs-keyword">module</span> Foo
    <span class="hljs-title">info</span>() <span class="hljs-keyword">=</span> <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;Information from Foo&quot;</span>
    <span class="hljs-title">warn</span>() <span class="hljs-keyword">=</span> <span class="hljs-meta">@warn</span> <span class="hljs-string">&quot;Warning from Foo&quot;</span>
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">.</span>Foo

<span class="hljs-comment"># Create the logger</span>
logger <span class="hljs-keyword">=</span> <span class="hljs-built_in">EarlyFilteredLogger</span>(<span class="hljs-built_in">global_logger</span>()) <span class="hljs-keyword">do</span> args
    r <span class="hljs-keyword">=</span> Logging<span class="hljs-built_in">.</span>Info <span class="hljs-built_in">&lt;=</span> args<span class="hljs-built_in">.</span>level <span class="hljs-built_in">&lt;</span> Logging<span class="hljs-built_in">.</span>Warn <span class="hljs-keyword">&amp;&amp;</span> args<span class="hljs-built_in">.</span>_module <span class="hljs-built_in">===</span> Foo
    <span class="hljs-keyword">return</span> r
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Test it</span>
<span class="hljs-built_in">with_logger</span>(logger) <span class="hljs-keyword">do</span>
    <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;Information from Main&quot;</span>
    <span class="hljs-meta">@warn</span> <span class="hljs-string">&quot;Warning from Main&quot;</span>
    Foo<span class="hljs-built_in">.</span><span class="hljs-built_in">info</span>()
    Foo<span class="hljs-built_in">.</span><span class="hljs-built_in">warn</span>()
<span class="hljs-keyword">end</span>
</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Information from Foo</code></pre><p>As you can see, the only message that wasn&#39;t dropped by the filter is the <code>@info</code> message from the <code>Foo</code> module!</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>MinLevelLogger</code> is just a special case of an <code>EarlyFilteredLogger</code> that only checks that the log level of the message is higher than the configured one.</p></div></div><p>Together with the <a href="../../reference/loggingextras/#LoggingExtras.TeeLogger-Tuple{Vararg{Base.CoreLogging.AbstractLogger}}"><code>TeeLogger</code></a> we can now create arbitrary routing for the messages. Here is a more complicated example:</p><pre><code class="language-julia hljs"><span class="hljs-keyword">using</span> Logging, LoggingExtras

logger <span class="hljs-keyword">=</span> <span class="hljs-built_in">TeeLogger</span>(
    <span class="hljs-built_in">global_logger</span>(),
    <span class="hljs-built_in">EarlyFilteredLogger</span>(
        args <span class="hljs-built_in">-&gt;</span> args<span class="hljs-built_in">.</span>_module <span class="hljs-built_in">===</span> WebServer,
        <span class="hljs-built_in">TeeLogger</span>(
            <span class="hljs-built_in">EarlyFilteredLogger</span>(
                args <span class="hljs-built_in">-&gt;</span> args<span class="hljs-built_in">.</span>level <span class="hljs-built_in">&lt;</span> Logging<span class="hljs-built_in">.</span>Info,
                <span class="hljs-built_in">FileLogger</span>(<span class="hljs-string">&quot;debug.log&quot;</span>),
            ),
            <span class="hljs-built_in">EarlyFilteredLogger</span>(
                args <span class="hljs-built_in">-&gt;</span> Logging<span class="hljs-built_in">.</span>Info <span class="hljs-built_in">&lt;=</span> args<span class="hljs-built_in">.</span>level <span class="hljs-built_in">&lt;</span> Logging<span class="hljs-built_in">.</span>Warn,
                <span class="hljs-built_in">FileLogger</span>(<span class="hljs-string">&quot;info.log&quot;</span>),
            ),
            <span class="hljs-built_in">EarlyFilteredLogger</span>(
                args <span class="hljs-built_in">-&gt;</span> Logging<span class="hljs-built_in">.</span>Warn <span class="hljs-built_in">&lt;=</span> args<span class="hljs-built_in">.</span>level,
                <span class="hljs-built_in">FileLogger</span>(<span class="hljs-string">&quot;warnings_and_errors.log&quot;</span>),
            ),
        )
    ),
)
</code></pre><p>This logger send all messages to the current global logger and an <code>EarlyFilteredLogger</code>. The <code>EarlyFilteredLogger</code> then drops all messages that doesn&#39;t come from the module <code>WebServer</code> and send the remaining ones to a new <code>TeeLogger</code>. This <code>TeeLogger</code> send messages to three <code>EarlyFilteredLogger</code>s that only keep messages of a certain level and send those to <code>FileLogger</code>s corresponding to the level. This means that, in <code>&quot;debug.log&quot;</code> there will only be messages that come from <code>WebServer</code> (the first filter) and that have debug log level. Similarly, in <code>&quot;info.log&quot;</code> there will only be messages with info log level, and any messages with higher level (warn, error) will end up in <code>&quot;warnings_and_errors.log&quot;</code>.</p><h3 id="Late-filtering-using-ActiveFilteredLogger"><a class="docs-heading-anchor" href="#Late-filtering-using-ActiveFilteredLogger">Late filtering using <code>ActiveFilteredLogger</code></a><a id="Late-filtering-using-ActiveFilteredLogger-1"></a><a class="docs-heading-anchor-permalink" href="#Late-filtering-using-ActiveFilteredLogger" title="Permalink"></a></h3><p>In case of filtering based on level, module, group, and id is not enough it is possible to use an <a href="../../reference/loggingextras/#LoggingExtras.ActiveFilteredLogger"><code>ActiveFilteredLogger</code></a>, also from the <a href="../../reference/loggingextras/#LoggingExtras.jl">LoggingExtras.jl</a> package. This logger is similar to the <code>EarlyFilteredLogger</code>, with the only difference that the named tuple that the predicate functions is given contains more data, see <a href="../../reference/loggingextras/#LoggingExtras.handle_message_args-Tuple"><code>LoggingExtras.handle_message_args</code></a>. Here is an example of a logger that filter based on the message string content:</p><pre><code class="language-julia hljs"><span class="hljs-keyword">using</span> Logging, LoggingExtras

logger <span class="hljs-keyword">=</span> <span class="hljs-built_in">ActiveFilteredLogger</span>(<span class="hljs-built_in">global_logger</span>()) <span class="hljs-keyword">do</span> args
    <span class="hljs-keyword">return</span> args<span class="hljs-built_in">.</span>message <span class="hljs-built_in">==</span> <span class="hljs-string">&quot;Hello there!&quot;</span> <span class="hljs-keyword">||</span> args<span class="hljs-built_in">.</span>message <span class="hljs-built_in">==</span> <span class="hljs-string">&quot;General Kenobi!&quot;</span>
<span class="hljs-keyword">end</span>

<span class="hljs-built_in">with_logger</span>(logger) <span class="hljs-keyword">do</span>
    <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;I find your lack of faith disturbing.&quot;</span>
    <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;Hello there!&quot;</span>
    <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;General Kenobi!&quot;</span>
    <span class="hljs-meta">@info</span> <span class="hljs-string">&quot;Power! Unlimited power!&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Hello there!
<span class="sgr36"><span class="sgr1">[ Info: </span></span>General Kenobi!</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tee/">« Send messages to multiple locations</a><a class="docs-footer-nextpage" href="../rotate-log-files/">How to rotate log files »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 23 August 2023 01:14">Wednesday 23 August 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
